/*! spaces-ui 2015-07-15 */
var Spaces=function(a){var b,c,d,e,f,g,h=function(){var a,c,d,h=document.querySelectorAll(b);f=Math.max(document.documentElement.clientWidth,window.innerWidth||0),g=Math.max(document.documentElement.clientHeight,window.innerHeight||0),e.style.position="fixed",e.style.top=0,e.style.left=0,e.style.transition="all 0.5s ease-in-out";for(var i=0;i<h.length;i++){c=h[i],c.style.position="absolute",c.style.left=i*f+"px",a=c.children;for(var j=0;j<a.length;j++)d=a[j],d.style.width=f+"px",d.style.height=g+"px",d.style.top=j*g+"px",d.tabIndex=-1,d.dataset.x=i,d.dataset.y=j}},i=function(){var a=document.querySelector(c);k(a.dataset.x,a.dataset.y)},j=function(){h(),i()},k=function(a,b){var c,h,i=document.querySelector("[data-active]"),j=document.querySelector('[data-x="'+a+'"][data-y="'+b+'"]');i&&i.removeAttribute("data-active"),j.dataset.active="",j.focus(),e.style.left=-a*f+"px",e.style.top=-b*g+"px",d&&(c=document.querySelector("[data-mapactive]"),c.style.background="transparent",c.removeAttribute("data-mapactive"),h=document.querySelector('[data-mapx="'+a+'"][data-mapy="'+b+'"]'),h.style.background="rgba(0, 0, 0, 0.5)",h.dataset.mapactive="")},l=function(a){var b,c,d,e=document.querySelector("[data-active]"),f=parseInt(e.dataset.x,10),g=parseInt(e.dataset.y,10);switch(a){case"up":b=f,c=g-1;break;case"down":b=f,c=g+1;break;case"left":b=f-1,c=g;break;case"right":b=f+1,c=g}d=document.querySelector('[data-x="'+b+'"][data-y="'+c+'"]'),d&&k(b,c)},m=function(){var a,d,e,f=20,g=10,h=document.createElement("div"),i=document.querySelector(c);h.style.position="absolute",h.id="spaces-map";for(var j=document.querySelectorAll(b),k=0;k<j.length;k++){d=document.createElement("ul"),d.style.position="relative",d.style.left=k*f+2+"px",a=j[k].children;for(var l=0;l<a.length;l++)e=document.createElement("li"),e.style.width=f+"px",e.style.height=g+"px",e.style.position="absolute",e.style.top=l*g+2+"px",e.style.border="1px solid #666",e.style.cursor="pointer",e.dataset.mapx=k,e.dataset.mapy=l,k==i.dataset.x&&l==i.dataset.y&&(e.dataset.mapactive="",e.style.background="rgba(0, 0, 0, 0.5)"),d.appendChild(e);h.appendChild(d)}h.style.bottom=g*j.length+20+"px",h.style.right=f*j.length+20+"px",document.body.appendChild(h)},n=function(){var a=arguments[0],b=a.keyCode;b=b>38?39==b?"right":"down":37==b?"left":"up",l(b)};_swipedetect=function(a,b){var c,d,e,f,g,h,i,j=a,k=50,l=100,m=1e3,n=b||function(a){};j.addEventListener("touchstart",function(a){var b=a.changedTouches[0];c="none",dist=0,d=b.pageX,e=b.pageY,i=(new Date).getTime()},!1),j.addEventListener("touchend",function(a){var b=a.changedTouches[0];f=b.pageX-d,g=b.pageY-e,h=(new Date).getTime()-i,m>=h&&(Math.abs(f)>=k&&Math.abs(g)<=l?c=0>f?"right":"left":Math.abs(g)>=k&&Math.abs(f)<=l&&(c=0>g?"down":"up")),n(c)},!1)};var o=function(){var a=arguments[0],b=a.target,c=b.dataset.mapx,d=b.dataset.mapy;c&&d&&k(c,d)},p=function(){window.addEventListener("keydown",n),window.addEventListener("resize",j),_swipedetect(e,function(a){l(a)}),d&&document.getElementById("spaces-map").addEventListener("click",o)},q=function(a){var f=a||{},g=f.spaceWrapper||"#spaces";c=f.initialSpace||'[data-x="0"][data-y="0"]',d=f.showMap||!1,b=g+"> *",e=document.querySelector(g),h(),d&&m(),i(),p()},r=function(a){var b=["up","down","left","right"],c=document.querySelector("[data-active]").dataset.x;"top"===a?k(c,0):b.indexOf(a)>-1&&l(a)},s=function(a){var b,c,d=document.querySelector(a);d&&(b=d.dataset.x,c=d.dataset.y,b&&c&&k(b,c))};return{init:q,move:r,moveTo:s}}();